```bash
wavemae/                         # GitHub リポジトリのルート（プロジェクト全体のトップディレクトリ）
│
├─ src/                          # Python パッケージのソースコードを格納するルート
│  └─ wavemae/                   # 実際に import される Python パッケージ本体（`import wavemae`）
│     ├─ __init__.py             # パッケージ初期化処理。__version__ の読み込み、サブパッケージの公開を行う
│     ├─ _version.py             # バージョン番号を一元管理するモジュール（例: __version__ = "0.1.0"）
│     ├─ py.typed                # 型チェッカーに型情報を認識させるためのマーカー
│     │
│     ├─ preprocessing/          # 前処理アルゴリズム群（スペクトル正規化など）
│     │  ├─ __init__.py          # サブパッケージの公開設定（例: snv, SNVScaler を import 時に利用可能に）
│     │  └─ snv.py               # SNV (Standard Normal Variate) 実装。1Dスペクトルの代表的前処理
│     │
│     ├─ models/                 # WaveMAE とその関連モデル
│     │  ├─ __init__.py          # モデル関連の公開APIをまとめる（WaveMAE / 損失関数 / ヘッド）
│     │  ├─ wave_mae.py          # WaveMAE 本体。TransformerベースのMAE実装
│     │  ├─ heads.py             # 投影ヘッドや識別用の出力層（今は空だが将来拡張を想定）
│     │  └─ losses.py            # 損失関数群（例: masked_sse, masked_mse など）
│     │
│     ├─ training/               # 学習と評価に関するモジュール
│     │  ├─ __init__.py          # Trainer/Tester/Optimizer utils を公開
│     │  ├─ trainer.py           # 学習ループ。AMP, EMA, checkpoint, 学習履歴の記録などを実装
│     │  ├─ tester.py            # 評価ループ。再構成誤差（SSE/MSE）でモデルを評価
│     │  ├─ extracter.py         # 潜在表現を一括抽出するためのユーティリティ
│     │  ├─ callbacks.py         # EarlyStopping や EMA などの学習フック群
│     │  └─ samplers.py          # Cosine 類似度に基づく WeightedRandomSampler の実装
│     │
│     ├─ clustering/             # クラスタリング関連モジュール
│     │  ├─ __init__.py          # CosineKMeans / ops を公開
│     │  ├─ cosine_kmeans.py     # Cosine-KMeans アルゴリズム本体
│     │  └─ ops.py               # クラスタリング用の補助関数（例: l2_normalize_rows）
│     │
│     ├─ utils/                  # 汎用的なユーティリティ群
│     │  ├─ __init__.py          # 公開APIを整理
│     │  ├─ seed.py              # 乱数シード固定・CUDNNの再現性制御
│     │  └─ load.py              # 学習済み重みのロード。SHA256検証付きダウンロード等
│     │
│     └─ assets/                       # サンプル重み・チェックサムなど（パッケージに同梱）
│        ├─ wavemae_base_256.pt        # 事前学習済み重み
│        └─ wavemae_base_256.pt.sha256 # 上記重みの SHA256 チェックサム（整合性確認用）
│
├─ tests/                           # Pytestベースのテスト群。パッケージの正しさを保証するための自動テストを集約
│  ├─ conftest.py                   # 共通fixture定義
│  │                                # - 乱数シード固定（再現性確保）
│  │                                # - 利用デバイス(cuda/cpu)の判定
│  │                                # - 一時ディレクトリ(tmpdir)などの共通セットアップ
│  │
│  ├─ test_import.py                # 基本的な import チェック
│  │                                # - `import wavemae` がエラー無く通るか
│  │                                # - サブモジュール（preprocessing, models, training, clustering, utils）が参照可能か
│  │
│  ├─ preprocessing/                # 前処理モジュールに関するテスト
│  │   └─ test_snv.py               # SNV 正規化の数値的妥当性を検証（平均=0, 分散=1になるか）
│  │
│  ├─ models/                       # モデル関連テスト（WaveMAE本体や損失関数）
│  │   ├─ test_losses.py            # masked_sse / masked_mse など損失関数の動作確認
│  │   ├─ test_wave_mae_forward.py  # WaveMAE の forward/encode/reconstruct 出力形状テスト
│  │   └─ test_wave_mae_mask.py     # マスク生成（ブロック数や比率）の性質をテスト
│  │
│  ├─ training/                     # 学習処理に関するテスト
│  │   ├─ test_trainer_smoke.py     # Trainer を極小データで1エポックだけ回すスモークテスト
│  │   └─ test_extracter.py         # Extracter で all_visible モード時に潜在ベクトルを抽出できるか
│  │
│  ├─ clustering/                   # クラスタリング関連テスト
│  │   ├─ test_ops.py               # ops.py 内のユーティリティ（例: l2_normalize_rows）の動作確認
│  │   └─ test_cosine_kmeans.py     # CosineKMeans の fit/predict/inertia を小規模データで検証
│  │
│  └─ utils/                        # ユーティリティ関連のテスト
│      └─ test_load.py              # load.py のテスト
│                                   # - get_default_config() の値チェック
│                                   # - 同梱アセット(重み.pt, .sha256)の存在確認
│                                   # - SHA256 検証が通るか（重みが無ければ skip）
│                                   # - load_default_pretrained() でモデルが正しくロードできるか
│                                   # - verify_hash=False モードでのロード確認　　
│                                    
├─ .github/                         # GitHub Actions 設定用のディレクトリ
│   └─ workflows/                   # ワークフローファイルを置く場所
│       └─ ci.yml                   # CI 定義ファイル
│                                   # - push/PR のたびに自動で pytest を実行
│                                   # - Python 3.9〜3.12 のマトリクスでテスト
│                                   # - CPU版PyTorchをインストールして tests/ を走らせる
│
├─ .gitignore                      # Git管理対象外にするファイル・ディレクトリの指定
├─ LICENSE                         # ライセンスファイル（MIT）
├─ MANIFEST.in                     # sdist 配布物に含めるファイルの指定（README, LICENSE, assets など）
├─ pyproject.toml                  # PEP 621 準拠のビルド設定・依存関係・メタ情報
└─ README.md                       # プロジェクトの説明。PyPIやGitHubで表示されるトップドキュメント
```

## To do

- tests 作成
- README.md 充実
- src/wavemae/assets/ に wavemae_base_256.pt と .sha256 を置く
- test でスキップしていた箇所修正
- test pypi 登録
- pypi 公開


## プッシュ順のおすすめ

- assets/ 配置 → コミット
- tests/ 追加 
- CLI追加
- README 強化 → コミット
- python -m build → TestPyPI → 本番
